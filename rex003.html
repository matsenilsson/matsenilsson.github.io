<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Mats E. Nilsson" />


<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/default.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 52px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 57px;
  margin-top: -57px;
}

.section h2 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h3 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h4 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h5 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h6 {
  padding-top: 57px;
  margin-top: -57px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">learn R by EXample</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="content.html">Content</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Seminar notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="rex001.html">001</a>
    </li>
    <li>
      <a href="rex002.html">002</a>
    </li>
    <li>
      <a href="rex003.html">003</a>
    </li>
    <li>
      <a href="rex004.html">004</a>
    </li>
    <li>
      <a href="rex005.html">005</a>
    </li>
    <li>
      <a href="rex006.html">006</a>
    </li>
    <li>
      <a href="rex101.html">101</a>
    </li>
    <li>
      <a href="rex102.html">102</a>
    </li>
    <li>
      <a href="rex102.html">103</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<p>   </p>
<div id="notes-rex003" class="section level1">
<h1>Notes REX003</h1>
<p>Today we’ll practice ‘subsetting’, i.e., extracting elements from data structures. R will make a lot more sense, once you have understood the basics of subsetting. Then we will continue working on our simulated experiment.</p>
<p> </p>
<div id="subsetting" class="section level2">
<h2>Subsetting</h2>
<p>Please spend time on the examples below; modify and extend them to get a grip of the various ways to extract parts of R objects. I’ve heard of people who gave up on R because they couldn’t find out how to calculate means for separate groups. It’s not totally intuitive, but once you know how, it’s easy. And more important, subsetting in R is extremely powerful, allowing you to analyze any subsets of your data.</p>
<p> </p>
<div id="vectors" class="section level3">
<h3>Vectors</h3>
<pre class="r"><code>z &lt;- seq(1, 100, 7)
z</code></pre>
<pre><code>##  [1]  1  8 15 22 29 36 43 50 57 64 71 78 85 92 99</code></pre>
<p>Use square brackets to subset parts of a vector (elements of vectors are indexed 1, 2, …, n).</p>
<pre class="r"><code>z[2]  # Second element</code></pre>
<pre><code>## [1] 8</code></pre>
<pre class="r"><code>z[-2]  # All but the second element</code></pre>
<pre><code>##  [1]  1 15 22 29 36 43 50 57 64 71 78 85 92 99</code></pre>
<pre class="r"><code>z[c(1,7,9)]  # Some selected elements</code></pre>
<pre><code>## [1]  1 43 57</code></pre>
<pre class="r"><code>z[z &gt; 50]  # All elements greater than 50</code></pre>
<pre><code>## [1] 57 64 71 78 85 92 99</code></pre>
<pre class="r"><code>z[length(z)]  # Last element</code></pre>
<pre><code>## [1] 99</code></pre>
<pre class="r"><code>z[z &lt; 1]  # Empty vector returned</code></pre>
<pre><code>## numeric(0)</code></pre>
<p>You have to use square brackets, ordinary brackets are for functions.</p>
<pre class="r"><code>z(3)</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): could not find function &quot;z&quot;</code></pre>
<p>Here is an example of the power of R: Subsetting one vector based on values in another variable.</p>
<pre class="r"><code>set.seed(123)
# IQs of a lot of people 
iq &lt;- rnorm(10^5, mean = 100, sd = 15) 
# Their gender
gender &lt;- sample(c(&#39;male&#39;, &#39;female&#39;, &#39;other&#39;), length(iq),
                 replace = TRUE, prob = c(.49, .49, .02))
# Gender of the smartest!
gender_smartest &lt;- gender[iq &gt; 145]  
table(gender_smartest)</code></pre>
<pre><code>## gender_smartest
## female   male  other 
##     58     70      3</code></pre>
<p> </p>
</div>
<div id="data-frames" class="section level3">
<h3>Data frames</h3>
<p>A data frame is a collection of vectors of the same length organized in rows (observations) and columns (variables). Use the dollar sign to extract a column (i.e., vector) from a data frame. You may then use square brackets to find subsets of data within the vector. Below an example using one of R’s preloaded data sets (use data() to list all of preloaded data sets).</p>
<pre class="r"><code># Assign R&#39;s preloaded data set &#39;sleep&#39; to data frame d. It contains data 
# on the effect of two sleep drugs on the amount of sleep re control nights
# in two groups of 10 patients each. 
d &lt;- sleep   
str(d)  # Check structure of d</code></pre>
<pre><code>## &#39;data.frame&#39;:    20 obs. of  3 variables:
##  $ extra: num  0.7 -1.6 -0.2 -1.2 -0.1 3.4 3.7 0.8 0 2 ...
##  $ group: Factor w/ 2 levels &quot;1&quot;,&quot;2&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ ID   : Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...</code></pre>
<pre class="r"><code># Subset outcome data: extra sleep on drug
d$extra  </code></pre>
<pre><code>##  [1]  0.7 -1.6 -0.2 -1.2 -0.1  3.4  3.7  0.8  0.0  2.0  1.9  0.8  1.1  0.1
## [15] -0.1  4.4  5.5  1.6  4.6  3.4</code></pre>
<pre class="r"><code># Subset outcome for group 1
d$extra[d$group == 1]  </code></pre>
<pre><code>##  [1]  0.7 -1.6 -0.2 -1.2 -0.1  3.4  3.7  0.8  0.0  2.0</code></pre>
<pre class="r"><code># Calculate difference between group medians 
median(d$group == 1) - median(d$group == 2)</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code># Group membership of those with positive effect
d$group[d$extra &gt; 0]</code></pre>
<pre><code>##  [1] 1 1 1 1 1 2 2 2 2 2 2 2 2 2
## Levels: 1 2</code></pre>
<p>You may also use square brackets to subset a data frame, but then you need two indices: one for rows, and the other for columns, separated by a comma. If you leave one empty, R assumes that you mean all rows or all columns.</p>
<pre class="r"><code>d[2, 1]  # Value of element in the second row of column 1</code></pre>
<pre><code>## [1] -1.6</code></pre>
<pre class="r"><code># Subset all the data for group 1; the output is a new data frame 
g1 &lt;- d[d$group == 1,]  
# Here&#39;s the same without dollar sign (as verified below)
g1b &lt;- d[d[,2] == 1,]
identical(g1, g1b)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p> </p>
</div>
<div id="exercises" class="section level3">
<h3>Exercises</h3>
<p>Create a vector called <code>x</code> with 1000 random numbers drawn from N(0,1): <code>x &lt;- rnorm(1000)</code>.</p>
<ol style="list-style-type: decimal">
<li>Create a new vector y with all elements of x greater than 0, and calculate the difference between the number of elements in y and the the number you would expect on average if you repeated the procedure many many times.</li>
<li>As 1, but for elements in x between -1 and 1.</li>
<li>As 1, but for elements in x smaller than -2 or greater than 2.</li>
</ol>
<p>Load R’s predefined data set <code>sleep</code> and use subsetting to create the following data structures:</p>
<ol start="4" style="list-style-type: decimal">
<li>A data frame only containing data from the patients with positive outcomes (positive values on the variable <code>extra</code>)</li>
<li>A numeric vector with all group values (1 or 2). [Hint: <code>as.numeric()</code> is useful]</li>
<li>A data frame with ID-numbers and outcomes for the five patients with largest gain in extra sleep.</li>
</ol>
<p> </p>
</div>
</div>
<div id="script-1-randomized-experiment-continued" class="section level2">
<h2>Script 1: Randomized experiment (continued)</h2>
<p>Click <a href="script1_2.R" target="_blank">here</a> for Script1 as we left it after the last seminar.</p>
<p>Today we will do the following:</p>
<ol style="list-style-type: decimal">
<li>Simulate potential outcomes</li>
<li>Define observed outcomes from potential outcomes and random assignments</li>
</ol>
<p>The observed outcome, <span class="math inline">\(Y_{obs}\)</span> is given by</p>
<p>  <span class="math inline">\(Y_{obs} = DY_1 + (1-D)Y_0\)</span>,<br />
<br />
where <span class="math inline">\(Y_0\)</span> is the potential outcome if untreated,<span class="math inline">\(Y_1\)</span> the potential outcome if treated, <span class="math inline">\(D = 1\)</span> for those that received treatment, and <span class="math inline">\(D = 0\)</span> for those who didn’t (assume, for now, that assigned and received treatments are identical).</p>
<p> </p>
<div id="exercises-1" class="section level3">
<h3>Exercises</h3>
<p>Next time we will analyze our outcome data (potential and observed). You may start right away, for example by calculating differences between means of potential outcomes (y0 vs y1) and means of experimental groups (treatment vs control). Verify that the two differences are close to identical for very large sample sizes.</p>
<p>   </p>
</div>
</div>
</div>



<span style = grey>
<hr>
<p>&copy Mats E. Nilsson<br>Gösta Ekman Laboratory, 
Department of Psychology, Stockholm University</p>

</span>



</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
